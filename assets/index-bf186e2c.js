import{b as S,o as N,g as x,d as et,t as b,s as B,e as dt,a as v,i as h,c as m,f as q,r as H,h as ht,j as nt}from"./entry-client-6b4024d6.js";const rt="#FF0800",st="#000000",[ft,pt]=S(rt),[gt,_t]=S(st),[J,z]=S([]),mt=()=>J().length===0,ot=t=>{const e=A();e&&(e.strokeStyle=t)},vt=(t=gt())=>ot(t),xt=(t=ft())=>ot(t),bt=b('<div class="relative flex justify-center"><div class="absolute image-prompt">Upload an image to begin</div><canvas id="main-canvas">Image canvas not loaded'),k="main-canvas",Y=t=>({mouseX:t.offsetX,mouseY:t.offsetY}),[X,F]=S(null),Z=()=>X()!==null,[A,$t]=S(null),[wt,yt]=S(null),Ct=()=>{const t=document.querySelector(`#${k}`),e=t.getBoundingClientRect(),n=t?.getContext("2d");$t(n),yt(e);const r=c=>{if(c.target.id!==k)return;const{mouseX:_,mouseY:u}=Y(c);F([_,u]),t.style.cursor="crosshair"},i=c=>{if(c.target.id!==k||!Z())return;const{mouseX:_,mouseY:u}=Y(c),[p,g]=X(),w=Math.abs(_-p),$=Math.abs(u-g);if(!(w<=10||$<=10))return t.style.cursor="default",z(y=>[...y,{startX:p,startY:g,width:_-p,height:u-g}]),M(),F(null)},o=c=>{if(c.target.id!=k||!Z())return;M();const{mouseX:_,mouseY:u}=Y(c),[p,g]=X();n.save(),n.beginPath(),xt(),n.setLineDash([6]),n.strokeRect(p,g,_-p,u-g),n.restore()},a=c=>{c.code==="Escape"&&(F(null),M(),t.style.cursor="default")};t.addEventListener("mousemove",o,!1),t.addEventListener("mousedown",r,!1),t.addEventListener("mouseup",i,!1),window.addEventListener("keydown",a,!1)},St={width:500,height:300,imgData:null,file:null},[j,Et]=S(St),Dt=()=>{const t=document.querySelector("#upload-input"),e=n=>{if(n.target.files.length===0)return;const r=A();if(!r)return;const i=n.target.files[0],o=new Image;o.onload=()=>{Et({width:o.width,height:o.height,imgData:o,file:i}),r.drawImage(o,0,0)},o.src=URL.createObjectURL(i)};t.addEventListener("change",e)},M=()=>{const t=A(),e=wt();if(!t||!e)return;const{imgData:n}=j();if(!n)return console.error("no image data in redrawAllBoxes");t.clearRect(0,0,e.width,e.height),t.drawImage(n,0,0),J().forEach(r=>{t.beginPath(),t.rect(r.startX,r.startY,r.width,r.height),vt(),t.stroke()})},Rt=()=>{const t=A();t&&(t.reset(),z([]))},Tt=()=>{A()&&(z(t=>t.slice(0,t.length-1)),M())},Bt=()=>{A()},Lt=()=>(N(()=>Ct()),N(()=>Dt()),(()=>{const t=x(bt),e=t.firstChild,n=e.nextSibling;return et(r=>{const i=j().width,o=j().height,a="relative rounded-md"+j().imgData?"canvas-shadow-active":"canvas-shadow-inactive";return i!==r._v$&&B(n,"width",r._v$=i),o!==r._v$2&&B(n,"height",r._v$2=o),a!==r._v$3&&dt(n,r._v$3=a),r},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()),At="application/json",it="Content-Type",T=Symbol(),lt=Symbol();function K(t={}){var e;return(e=Object.entries(t).find(([n])=>n.toLowerCase()===it.toLowerCase()))===null||e===void 0?void 0:e[1]}function Q(t){return/^application\/.*json.*/.test(t)}const E=function(t,e,n=!1){return Object.entries(e).reduce((r,[i,o])=>{const a=t[i];return Array.isArray(a)&&Array.isArray(o)?r[i]=n?[...a,...o]:o:typeof a=="object"&&typeof o=="object"?r[i]=E(a,o,n):r[i]=o,r},{...t})},L={options:{},errorType:"text",polyfills:{},polyfill(t,e=!0,n=!1,...r){const i=this.polyfills[t]||(typeof self<"u"?self[t]:null)||(typeof global<"u"?global[t]:null);if(e&&!i)throw new Error(t+" is not defined");return n&&i?new i(...r):i}};function Ot(t,e=!1){L.options=e?t:E(L.options,t)}function jt(t,e=!1){L.polyfills=e?t:E(L.polyfills,t)}function kt(t){L.errorType=t}const Mt=t=>e=>t.reduceRight((n,r)=>r(n),e)||e;class at extends Error{}const Pt=t=>{const e=Object.create(null);t=t._addons.reduce((s,l)=>l.beforeRequest&&l.beforeRequest(s,t._options,e)||s,t);const{_url:n,_options:r,_config:i,_catchers:o,_resolvers:a,_middlewares:c,_addons:_}=t,u=new Map(o),p=E(i.options,r);let g=n;const w=Mt(c)((s,l)=>(g=s,i.polyfill("fetch")(s,l)))(n,p),$=new Error,y=w.catch(s=>{throw{[T]:s}}).then(s=>{if(!s.ok){const l=new at;if(l.cause=$,l.stack=l.stack+`
CAUSE: `+$.stack,l.response=s,l.url=g,s.type==="opaque")throw l;return s.text().then(d=>{var f;if(l.message=d,i.errorType==="json"||((f=s.headers.get("Content-Type"))===null||f===void 0?void 0:f.split(";")[0])==="application/json")try{l.json=JSON.parse(d)}catch{}throw l.text=d,l.status=s.status,l})}return s}),R=s=>s.catch(l=>{const d=l.hasOwnProperty(T),f=d?l[T]:l,I=f?.status&&u.get(f.status)||u.get(f?.name)||d&&u.has(T)&&u.get(T);if(I)return I(f,t);const G=u.get(lt);if(G)return G(f,t);throw f}),C=s=>l=>R(s?y.then(d=>d&&d[s]()).then(d=>l?l(d):d):y.then(d=>l?l(d):d)),U={_wretchReq:t,_fetchReq:w,_sharedState:e,res:C(null),json:C("json"),blob:C("blob"),formData:C("formData"),arrayBuffer:C("arrayBuffer"),text:C("text"),error(s,l){return u.set(s,l),this},badRequest(s){return this.error(400,s)},unauthorized(s){return this.error(401,s)},forbidden(s){return this.error(403,s)},notFound(s){return this.error(404,s)},timeout(s){return this.error(408,s)},internalError(s){return this.error(500,s)},fetchError(s){return this.error(T,s)}},O=_.reduce((s,l)=>({...s,...l.resolver}),U);return a.reduce((s,l)=>l(s,t),O)},Ut={_url:"",_options:{},_config:L,_catchers:new Map,_resolvers:[],_deferred:[],_middlewares:[],_addons:[],addon(t){return{...this,_addons:[...this._addons,t],...t.wretch}},errorType(t){return{...this,_config:{...this._config,errorType:t}}},polyfills(t,e=!1){return{...this,_config:{...this._config,polyfills:e?t:E(this._config.polyfills,t)}}},url(t,e=!1){if(e)return{...this,_url:t};const n=this._url.split("?");return{...this,_url:n.length>1?n[0]+t+"?"+n[1]:this._url+t}},options(t,e=!1){return{...this,_options:e?t:E(this._options,t)}},headers(t){return{...this,_options:E(this._options,{headers:t||{}})}},accept(t){return this.headers({Accept:t})},content(t){return this.headers({[it]:t})},auth(t){return this.headers({Authorization:t})},catcher(t,e){const n=new Map(this._catchers);return n.set(t,e),{...this,_catchers:n}},catcherFallback(t){return this.catcher(lt,t)},resolve(t,e=!1){return{...this,_resolvers:e?[t]:[...this._resolvers,t]}},defer(t,e=!1){return{...this,_deferred:e?[t]:[...this._deferred,t]}},middlewares(t,e=!1){return{...this,_middlewares:e?t:[...this._middlewares,...t]}},fetch(t=this._options.method,e="",n=null){let r=this.url(e).options({method:t});const i=K(r._options.headers),o=typeof n=="object"&&(!r._options.headers||!i||Q(i));return r=n?o?r.json(n,i):r.body(n):r,Pt(r._deferred.reduce((a,c)=>c(a,a._url,a._options),r))},get(t=""){return this.fetch("GET",t)},delete(t=""){return this.fetch("DELETE",t)},put(t,e=""){return this.fetch("PUT",e,t)},post(t,e=""){return this.fetch("POST",e,t)},patch(t,e=""){return this.fetch("PATCH",e,t)},head(t=""){return this.fetch("HEAD",t)},opts(t=""){return this.fetch("OPTIONS",t)},body(t){return{...this,_options:{...this._options,body:t}}},json(t,e){const n=K(this._options.headers);return this.content(e||Q(n)&&n||At).body(JSON.stringify(t))}};function D(t="",e={}){return{...Ut,_url:t,_options:e}}D.default=D;D.options=Ot;D.errorType=kt;D.polyfills=jt;D.WretchError=at;var W=(t=>(t.ServerDown="Server seems to be down currently. You can still play around with the application, but the server won't be able to process your submission. Please try again later and if it persists please submit an issue on GitHub.",t.BadInput="Server received invalid input, but this is unexpected. You can try to refresh the page and try again. ",t.UncaughtError="An unexpected unknown error occurred. ",t))(W||{});const[P,ct]=S(null),It={serverBaseUrl:{development:"http://localhost:8080/",production:"https://capserver.ncn.dev/"}},Yt="production",ut=It.serverBaseUrl[Yt],Ft=t=>ct({msg:W.BadInput,additionalDataStr:t.response.body?JSON.stringify(t.message):void 0}),Nt=D(ut).resolve(t=>t.error(422,Ft)),Xt=async t=>{try{const e=`${ut}submit`,n=new FormData;n.append("file",t.file),n.append("box_data",JSON.stringify({boxes:[{startX:5,startY:5,width:100,height:100}]})),n.append("intro","hello testing");const r=await fetch(e,{method:"POST",body:n});console.log("response",r)}catch(e){console.log(e)}},qt=()=>{Nt.url("ping").get().json(t=>t).catch(t=>ct({msg:W.ServerDown}))},Ht=b('<svg fill="currentColor" stroke-width="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" height="1em" width="1em" style="overflow:visible;"><path d="m1 1.91.78-.41L15 7.449v.95L1.78 14.33 1 13.91 2.583 8 1 1.91ZM3.612 8.5 2.33 13.13 13.5 7.9 2.33 2.839l1.282 4.6L9 7.5v1H3.612Z">'),Jt=b('<svg fill="currentColor" stroke-width="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" height="1em" width="1em" style="overflow:visible;"><path d="M8 1a7.979 7.979 0 0 0-5.657 2.343L0 1v6h6L3.757 4.757a6 6 0 1 1 8.211 8.743l1.323 1.5A8 8 0 0 0 8 1z">'),zt=b('<svg fill="currentColor" stroke-width="0" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" height="1em" width="1em" style="overflow:visible;"><path d="M12 16c1.671 0 3-1.331 3-3s-1.329-3-3-3-3 1.331-3 3 1.329 3 3 3z"></path><path d="M20.817 11.186a8.94 8.94 0 0 0-1.355-3.219 9.053 9.053 0 0 0-2.43-2.43 8.95 8.95 0 0 0-3.219-1.355 9.028 9.028 0 0 0-1.838-.18V2L8 5l3.975 3V6.002c.484-.002.968.044 1.435.14a6.961 6.961 0 0 1 2.502 1.053 7.005 7.005 0 0 1 1.892 1.892A6.967 6.967 0 0 1 19 13a7.032 7.032 0 0 1-.55 2.725 7.11 7.11 0 0 1-.644 1.188 7.2 7.2 0 0 1-.858 1.039 7.028 7.028 0 0 1-3.536 1.907 7.13 7.13 0 0 1-2.822 0 6.961 6.961 0 0 1-2.503-1.054 7.002 7.002 0 0 1-1.89-1.89A6.996 6.996 0 0 1 5 13H3a9.02 9.02 0 0 0 1.539 5.034 9.096 9.096 0 0 0 2.428 2.428A8.95 8.95 0 0 0 12 22a9.09 9.09 0 0 0 1.814-.183 9.014 9.014 0 0 0 3.218-1.355 8.886 8.886 0 0 0 1.331-1.099 9.228 9.228 0 0 0 1.1-1.332A8.952 8.952 0 0 0 21 13a9.09 9.09 0 0 0-.183-1.814z">'),Wt=()=>x(Ht),Gt=()=>x(Jt),Zt=({cls:t})=>(()=>{const e=x(zt);return B(e,"class",t),e})(),Kt=b('<div class="flex flex-col items-center"><input type="color"><label class="text-neutral-500">'),Qt=b('<button class="tool-button cursor-pointer"><!#><!/><label class="text-neutral-500 hover:text-sky-600 cursor-pointer">'),Vt=b('<button class="flex items-center gap-2 bg-green-600 disabled:bg-neutral-700 rounded-sm p-2 duration-300"><span>Submit</span><!#><!/>'),te=b('<div class="text-white text-md flex justify-center gap-4 items-start"><!#><!/><!#><!/><div class="mt-4 gap-4 flex text-center"><input type="file" accept="image/*" id="upload-input" class="w-32"></div><!#><!/><!#><!/><!#><!/>'),V=({id:t,label:e,onChange:n,defaultColor:r})=>(()=>{const i=x(Kt),o=i.firstChild,a=o.nextSibling;return q(o,"change",n),B(o,"id",t),B(o,"name",t),o.value=r,B(a,"for",t),h(a,e),i})(),tt=({icon:t,label:e,onClick:n})=>(()=>{const r=x(Qt),i=r.firstChild,[o,a]=v(i.nextSibling),c=o.nextSibling;return q(r,"click",n,!0),h(r,t,o,a),h(c,e),H(),r})(),ee=()=>(()=>{const t=x(Vt),e=t.firstChild,n=e.nextSibling,[r,i]=v(n.nextSibling);return t.$$click=o=>Xt({intro:"placeholder intro msg",boxes:J(),file:j().file}),h(t,m(Wt,{}),r,i),et(()=>t.disabled=mt()),H(),t})(),ne=()=>(()=>{const t=x(te),e=t.firstChild,[n,r]=v(e.nextSibling),i=n.nextSibling,[o,a]=v(i.nextSibling),c=o.nextSibling,_=c.firstChild,u=c.nextSibling,[p,g]=v(u.nextSibling),w=p.nextSibling,[$,y]=v(w.nextSibling),R=$.nextSibling,[C,U]=v(R.nextSibling);return h(t,m(V,{id:"drawing-color",label:"Drawing",defaultColor:rt,onChange:O=>pt(O.target.value)}),n,r),h(t,m(V,{id:"box-color",label:"Box",defaultColor:st,onChange:O=>_t(O.target.value)}),o,a),q(_,"click",Bt,!0),h(t,m(tt,{get icon(){return m(Gt,{})},label:"Undo",onClick:Tt}),p,g),h(t,m(tt,{get icon(){return m(Zt,{cls:"text-lg"})},label:"Reset",onClick:Rt}),$,y),h(t,m(ee,{}),C,U),H(),t})();ht(["click"]);const re=b('<aside class="error-menu"><p>Error!</p><p></p><!#><!/>'),se=b("<p>"),oe=()=>(()=>{const t=x(re),e=t.firstChild,n=e.nextSibling,r=n.nextSibling,[i,o]=v(r.nextSibling);return h(n,()=>P()?.msg),h(t,(()=>{const a=nt(()=>!!P()?.additionalDataStr);return()=>a()&&(()=>{const c=x(se);return h(c,()=>P()?.additionalDataStr),c})()})(),i,o),t})(),ie=b('<div class="text-center flex flex-col items-center flex-auto"><main class="flex flex-col"><div class="flex flex-col mb-24"><h1 class="max-6-xs text-6xl text-sky-700 font-thin uppercase my-4">Capstone</h1><p class="text-md text-neutral-500">Tips</p><ul class="mb-8"><li class="basic-text">- Press ctrl + Z to undo last box</li><li class="basic-text">- Press Esc to stop drawing</li></ul><!#><!/><!#><!/></div><!#><!/>');function ae(){return N(()=>qt()),(()=>{const t=x(ie),e=t.firstChild,n=e.firstChild,r=n.firstChild,i=r.nextSibling,o=i.nextSibling,a=o.nextSibling,[c,_]=v(a.nextSibling),u=c.nextSibling,[p,g]=v(u.nextSibling),w=n.nextSibling,[$,y]=v(w.nextSibling);return h(n,(()=>{const R=nt(()=>!!P());return()=>R()&&m(oe,{})})(),c,_),h(n,m(ne,{}),p,g),h(e,m(Lt,{}),$,y),t})()}export{ae as default};
