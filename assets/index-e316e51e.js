import{b as C,o as J,g as $,a as m,i as p,c as f,S as me,d as j,s as re,e as be,t as x,f as se,h as ve,C as oe,U as $e,R as xe,j as ye,k as Se,l as ce,m as we,r as Z,n as Ce,p as Ee,u as G,q as ue}from"./entry-client-01c03f8b.js";const De="#FF10F0",Re="#39FF14",[M,ke]=C(De),[O,Te]=C(Re),[Q,V]=C([]),Ie=()=>Q().length===0,de=e=>{const t=B();t&&(t.strokeStyle=e)},Be=(e=O())=>de(e),Ue=(e=M())=>de(e),Le={width:500,height:300,imgData:null,file:null},[E,Oe]=C(Le),je=()=>!!E().imgData,Ae=x('<div class="absolute image-prompt z-10">Upload an image to begin'),Pe=x('<div class="relative flex justify-center"><!#><!/><canvas id="main-canvas">Image canvas not loaded'),F="main-canvas",W=e=>({mouseX:e.offsetX,mouseY:e.offsetY}),[K,z]=C(null),ie=()=>K()!==null,[B,Fe]=C(null),[Me,Ye]=C(null),qe=()=>{const e=document.querySelector(`#${F}`),t=e.getBoundingClientRect(),n=e?.getContext("2d");Fe(n),Ye(t);const r=l=>{if(l.target.id!==F)return;const{mouseX:u,mouseY:d}=W(l);z([u,d]),e.style.cursor="crosshair"},o=l=>{if(l.target.id!==F||!ie())return;const{mouseX:u,mouseY:d}=W(l),[b,_]=K(),v=Math.abs(u-b),y=Math.abs(d-_);if(!(v<=10||y<=10))return e.style.cursor="default",V(S=>[...S,{startX:b,startY:_,width:u-b,height:d-_}]),Y(),z(null)},i=l=>{if(l.target.id!=F||!ie())return;Y();const{mouseX:u,mouseY:d}=W(l),[b,_]=K();n.save(),n.beginPath(),Ue(),n.setLineDash([6]),n.strokeRect(b,_,u-b,d-_),n.restore()},c=l=>{l.code==="Escape"&&(z(null),Y(),e.style.cursor="default"),l.ctrlKey&&l.key==="z"&&he()};e.addEventListener("mousemove",i,!1),e.addEventListener("mousedown",r,!1),e.addEventListener("mouseup",o,!1),window.addEventListener("keydown",c,!1)},Ne=()=>{const e=document.querySelector("#upload-input"),t=n=>{if(n.target.files.length===0)return;const r=B();if(!r)return;const o=n.target.files[0],i=new Image;i.onload=()=>{Oe({width:i.width,height:i.height,imgData:i,file:o}),r.drawImage(i,0,0)},i.src=URL.createObjectURL(o)};e?.addEventListener("change",t)},Y=()=>{const e=B(),t=Me();if(!e||!t)return;const{imgData:n}=E();if(!n)return console.error("no image data in redrawAllBoxes");e.clearRect(0,0,t.width,t.height),e.drawImage(n,0,0),Q().forEach(r=>{e.beginPath(),e.rect(r.startX,r.startY,r.width,r.height),Be(),e.stroke()})},Xe=()=>{const e=B();e&&(e.reset(),V([]))},he=()=>{B()&&(V(e=>e.slice(0,e.length-1)),Y())},He=()=>{B()},We=()=>(J(()=>qe()),J(()=>Ne()),(()=>{const e=$(Pe),t=e.firstChild,[n,r]=m(t.nextSibling),o=n.nextSibling;return p(e,f(me,{get when(){return!E().file},get children(){return $(Ae)}}),n,r),j(i=>{const c=E().width,l=E().height,u="canvas "+E().imgData?"canvas-shadow-active":"canvas-shadow-inactive";return c!==i._v$&&re(o,"width",i._v$=c),l!==i._v$2&&re(o,"height",i._v$2=l),u!==i._v$3&&be(o,i._v$3=u),i},{_v$:void 0,_v$2:void 0,_v$3:void 0}),e})()),ze="application/json",fe="Content-Type",T=Symbol(),ge=Symbol();function le(e={}){var t;return(t=Object.entries(e).find(([n])=>n.toLowerCase()===fe.toLowerCase()))===null||t===void 0?void 0:t[1]}function ae(e){return/^application\/.*json.*/.test(e)}const D=function(e,t,n=!1){return Object.entries(t).reduce((r,[o,i])=>{const c=e[o];return Array.isArray(c)&&Array.isArray(i)?r[o]=n?[...c,...i]:i:typeof c=="object"&&typeof i=="object"?r[o]=D(c,i,n):r[o]=i,r},{...e})},I={options:{},errorType:"text",polyfills:{},polyfill(e,t=!0,n=!1,...r){const o=this.polyfills[e]||(typeof self<"u"?self[e]:null)||(typeof global<"u"?global[e]:null);if(t&&!o)throw new Error(e+" is not defined");return n&&o?new o(...r):o}};function Je(e,t=!1){I.options=t?e:D(I.options,e)}function Ge(e,t=!1){I.polyfills=t?e:D(I.polyfills,e)}function Ke(e){I.errorType=e}const Ze=e=>t=>e.reduceRight((n,r)=>r(n),t)||t;class pe extends Error{}const Qe=e=>{const t=Object.create(null);e=e._addons.reduce((s,a)=>a.beforeRequest&&a.beforeRequest(s,e._options,t)||s,e);const{_url:n,_options:r,_config:o,_catchers:i,_resolvers:c,_middlewares:l,_addons:u}=e,d=new Map(i),b=D(o.options,r);let _=n;const v=Ze(l)((s,a)=>(_=s,o.polyfill("fetch")(s,a)))(n,b),y=new Error,S=v.catch(s=>{throw{[T]:s}}).then(s=>{if(!s.ok){const a=new pe;if(a.cause=y,a.stack=a.stack+`
CAUSE: `+y.stack,a.response=s,a.url=_,s.type==="opaque")throw a;return s.text().then(h=>{var g;if(a.message=h,o.errorType==="json"||((g=s.headers.get("Content-Type"))===null||g===void 0?void 0:g.split(";")[0])==="application/json")try{a.json=JSON.parse(h)}catch{}throw a.text=h,a.status=s.status,a})}return s}),k=s=>s.catch(a=>{const h=a.hasOwnProperty(T),g=h?a[T]:a,U=g?.status&&d.get(g.status)||d.get(g?.name)||h&&d.has(T)&&d.get(T);if(U)return U(g,e);const P=d.get(ge);if(P)return P(g,e);throw g}),w=s=>a=>k(s?S.then(h=>h&&h[s]()).then(h=>a?a(h):h):S.then(h=>a?a(h):h)),A={_wretchReq:e,_fetchReq:v,_sharedState:t,res:w(null),json:w("json"),blob:w("blob"),formData:w("formData"),arrayBuffer:w("arrayBuffer"),text:w("text"),error(s,a){return d.set(s,a),this},badRequest(s){return this.error(400,s)},unauthorized(s){return this.error(401,s)},forbidden(s){return this.error(403,s)},notFound(s){return this.error(404,s)},timeout(s){return this.error(408,s)},internalError(s){return this.error(500,s)},fetchError(s){return this.error(T,s)}},X=u.reduce((s,a)=>({...s,...a.resolver}),A);return c.reduce((s,a)=>a(s,e),X)},Ve={_url:"",_options:{},_config:I,_catchers:new Map,_resolvers:[],_deferred:[],_middlewares:[],_addons:[],addon(e){return{...this,_addons:[...this._addons,e],...e.wretch}},errorType(e){return{...this,_config:{...this._config,errorType:e}}},polyfills(e,t=!1){return{...this,_config:{...this._config,polyfills:t?e:D(this._config.polyfills,e)}}},url(e,t=!1){if(t)return{...this,_url:e};const n=this._url.split("?");return{...this,_url:n.length>1?n[0]+e+"?"+n[1]:this._url+e}},options(e,t=!1){return{...this,_options:t?e:D(this._options,e)}},headers(e){return{...this,_options:D(this._options,{headers:e||{}})}},accept(e){return this.headers({Accept:e})},content(e){return this.headers({[fe]:e})},auth(e){return this.headers({Authorization:e})},catcher(e,t){const n=new Map(this._catchers);return n.set(e,t),{...this,_catchers:n}},catcherFallback(e){return this.catcher(ge,e)},resolve(e,t=!1){return{...this,_resolvers:t?[e]:[...this._resolvers,e]}},defer(e,t=!1){return{...this,_deferred:t?[e]:[...this._deferred,e]}},middlewares(e,t=!1){return{...this,_middlewares:t?e:[...this._middlewares,...e]}},fetch(e=this._options.method,t="",n=null){let r=this.url(t).options({method:e});const o=le(r._options.headers),i=typeof n=="object"&&(!r._options.headers||!o||ae(o));return r=n?i?r.json(n,o):r.body(n):r,Qe(r._deferred.reduce((c,l)=>l(c,c._url,c._options),r))},get(e=""){return this.fetch("GET",e)},delete(e=""){return this.fetch("DELETE",e)},put(e,t=""){return this.fetch("PUT",t,e)},post(e,t=""){return this.fetch("POST",t,e)},patch(e,t=""){return this.fetch("PATCH",t,e)},head(e=""){return this.fetch("HEAD",e)},opts(e=""){return this.fetch("OPTIONS",e)},body(e){return{...this,_options:{...this._options,body:e}}},json(e,t){const n=le(this._options.headers);return this.content(t||ae(n)&&n||ze).body(JSON.stringify(e))}};function R(e="",t={}){return{...Ve,_url:e,_options:t}}R.default=R;R.options=Je;R.errorType=Ke;R.polyfills=Ge;R.WretchError=pe;var ee=(e=>(e.ServerDown="Server seems to be down currently. You can still play around with the application, but the server won't be able to process your submission. Please try again later and if it persists please submit an issue on GitHub.",e.BadInput="Server received invalid input, but this is unexpected. You can try to refresh the page and try again. ",e.UncaughtError="An unexpected unknown error occurred. ",e))(ee||{});const[q,_e]=C(null),et={serverBaseUrl:{development:"http://localhost:8080/",production:"https://capserver.ncn.dev/"}},tt="production",N=et.serverBaseUrl[tt],nt=e=>_e({msg:ee.BadInput,additionalDataStr:e.response.body?JSON.stringify(e.message):void 0}),rt=R(N).resolve(e=>e.error(422,nt)),st=async e=>{try{se(!0);const t=`${N}submit`,n=new FormData;n.append("file",e.file),n.append("box_data",JSON.stringify({boxes:e.boxes})),n.append("intro","hello testing");const o=await(await fetch(t,{method:"POST",body:n})).json();se(!1),ve({seg:`${N}${o.seg_img_path}`,outline:`${N}${o.outline_img_path}`}),console.log("response",o)}catch(t){console.log(t)}},ot=()=>{rt.url("ping").get().json(e=>e).catch(e=>_e({msg:ee.ServerDown}))},it=x('<button class="tool-button cursor-pointer"><!#><!/><label class="text-neutral-400 hover:text-sky-600 cursor-pointer mt-0.5">'),lt=x('<button class="flex items-center gap-2 bg-green-600 disabled:bg-neutral-700 rounded-sm p-2 duration-300"><span>Submit</span><!#><!/>'),at=x('<input type="file" accept="image/*" id="upload-input" class="w-32 hidden">'),ct=x('<div class="text-white text-md flex justify-center gap-4 items-center"><!#><!/><div class="flex"><input type="color" id="drawing-color" name="drawing-color-input" class="w-0 h-0 -z-50"><!#><!/></div><div class="flex"><input type="color" id="box-color" name="box-color-input" class="w-0 h-0 -z-50"><!#><!/></div><!#><!/><!#><!/><!#><!/>'),L=e=>(()=>{const t=$(it),n=t.firstChild,[r,o]=m(n.nextSibling),i=r.nextSibling;return ce(t,"click",e.onClick,!0),p(t,()=>e.icon,r,o),p(i,()=>e.label),j(c=>{const l=!!e.flexibleWidth,u=e.style;return l!==c._v$&&t.classList.toggle("flexible",c._v$=l),c._v$2=we(t,u,c._v$2),c},{_v$:void 0,_v$2:void 0}),Z(),t})(),ut=()=>(()=>{const e=$(lt),t=e.firstChild,n=t.nextSibling,[r,o]=m(n.nextSibling);return e.$$click=i=>st({intro:"placeholder intro msg",boxes:Q(),file:E().file}),p(e,f(Ce,{}),r,o),j(()=>e.disabled=Ie()),Z(),e})(),dt=()=>{let e;const t=()=>{e?.click()};return[(()=>{const n=$(at);ce(n,"click",He,!0);const r=e;return typeof r=="function"?G(r,n):e=n,Z(),n})(),f(L,{get icon(){return f(Ee,{})},get label(){return je()?"Change Image":"Upload Image"},onClick:()=>t(),flexibleWidth:!0})]},ht=()=>{let e,t;return(()=>{const n=$(ct),r=n.firstChild,[o,i]=m(r.nextSibling),c=o.nextSibling,l=c.firstChild,u=l.nextSibling,[d,b]=m(u.nextSibling),_=c.nextSibling,v=_.firstChild,y=v.nextSibling,[S,k]=m(y.nextSibling),w=_.nextSibling,[A,X]=m(w.nextSibling),s=A.nextSibling,[a,h]=m(s.nextSibling),g=a.nextSibling,[U,P]=m(g.nextSibling);p(n,f(dt,{}),o,i);const te=e;typeof te=="function"?G(te,l):e=l,l.addEventListener("change",H=>ke(H.target.value)),p(c,f(L,{get icon(){return f(oe,{get style(){return{color:M()}}})},label:"Drawing",onClick:()=>e?.click(),get style(){return{"border-color":M()}}}),d,b);const ne=t;return typeof ne=="function"?G(ne,v):t=v,v.addEventListener("change",H=>Te(H.target.value)),p(_,f(L,{get icon(){return f(oe,{get style(){return{color:O()}}})},label:"Box",onClick:()=>t?.click(),get style(){return{"border-color":O()}}}),S,k),p(n,f(L,{get icon(){return f($e,{})},label:"Undo",onClick:he}),A,X),p(n,f(L,{get icon(){return f(xe,{cls:"text-lg"})},label:"Reset",onClick:Xe}),a,h),p(n,f(ut,{}),U,P),j(()=>l.value=M()),j(()=>v.value=O()),n})()};ye(()=>{console.log("The color is now",O())});Se(["click"]);const ft=x('<aside class="error-menu"><p>Error!</p><p></p><!#><!/>'),gt=x("<p>"),pt=()=>(()=>{const e=$(ft),t=e.firstChild,n=t.nextSibling,r=n.nextSibling,[o,i]=m(r.nextSibling);return p(n,()=>q()?.msg),p(e,(()=>{const c=ue(()=>!!q()?.additionalDataStr);return()=>c()&&(()=>{const l=$(gt);return p(l,()=>q()?.additionalDataStr),l})()})(),o,i),e})(),_t=x('<div class="text-center flex flex-col items-center flex-auto"><main class="flex flex-col"><div class="flex flex-col mb-24"><h1 class="max-6-xs text-6xl text-sky-700 font-thin uppercase my-4">Capstone</h1><p class="text-md text-neutral-500">Tips</p><ul class="mb-8"><li class="basic-text">- Press ctrl + Z to undo last box</li><li class="basic-text">- Press Esc to stop drawing</li></ul><!#><!/><!#><!/></div><!#><!/>');function bt(){return J(()=>ot()),(()=>{const e=$(_t),t=e.firstChild,n=t.firstChild,r=n.firstChild,o=r.nextSibling,i=o.nextSibling,c=i.nextSibling,[l,u]=m(c.nextSibling),d=l.nextSibling,[b,_]=m(d.nextSibling),v=n.nextSibling,[y,S]=m(v.nextSibling);return p(n,(()=>{const k=ue(()=>!!q());return()=>k()&&f(pt,{})})(),l,u),p(n,f(ht,{}),b,_),p(t,f(We,{}),y,S),e})()}export{bt as default};
