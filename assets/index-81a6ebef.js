import{b as C,o as q,g as S,d as st,s as L,e as ht,t as w,f as Z,h as ft,a as b,i as h,c as m,j as H,U as pt,R as gt,r as J,k as _t,S as mt,l as rt}from"./entry-client-da49c854.js";const ot="#FF0800",it="#000000",[bt,xt]=C(ot),[vt,$t]=C(it),[W,G]=C([]),yt=()=>W().length===0,at=t=>{const e=O();e&&(e.strokeStyle=t)},St=(t=vt())=>at(t),Ct=(t=bt())=>at(t),wt=w('<div class="relative flex justify-center"><div class="absolute image-prompt">Upload an image to begin</div><canvas id="main-canvas">Image canvas not loaded'),k="main-canvas",Y=t=>({mouseX:t.offsetX,mouseY:t.offsetY}),[X,N]=C(null),Q=()=>X()!==null,[O,Et]=C(null),[Dt,Rt]=C(null),Tt=()=>{const t=document.querySelector(`#${k}`),e=t.getBoundingClientRect(),n=t?.getContext("2d");Et(n),Rt(e);const s=c=>{if(c.target.id!==k)return;const{mouseX:_,mouseY:u}=Y(c);N([_,u]),t.style.cursor="crosshair"},r=c=>{if(c.target.id!==k||!Q())return;const{mouseX:_,mouseY:u}=Y(c),[p,g]=X(),v=Math.abs(_-p),x=Math.abs(u-g);if(!(v<=10||x<=10))return t.style.cursor="default",G($=>[...$,{startX:p,startY:g,width:_-p,height:u-g}]),P(),N(null)},i=c=>{if(c.target.id!=k||!Q())return;P();const{mouseX:_,mouseY:u}=Y(c),[p,g]=X();n.save(),n.beginPath(),Ct(),n.setLineDash([6]),n.strokeRect(p,g,_-p,u-g),n.restore()},l=c=>{c.code==="Escape"&&(N(null),P(),t.style.cursor="default")};t.addEventListener("mousemove",i,!1),t.addEventListener("mousedown",s,!1),t.addEventListener("mouseup",r,!1),window.addEventListener("keydown",l,!1)},Bt={width:500,height:300,imgData:null,file:null},[A,Ot]=C(Bt),jt=()=>{const t=document.querySelector("#upload-input"),e=n=>{if(n.target.files.length===0)return;const s=O();if(!s)return;const r=n.target.files[0],i=new Image;i.onload=()=>{Ot({width:i.width,height:i.height,imgData:i,file:r}),s.drawImage(i,0,0)},i.src=URL.createObjectURL(r)};t.addEventListener("change",e)},P=()=>{const t=O(),e=Dt();if(!t||!e)return;const{imgData:n}=A();if(!n)return console.error("no image data in redrawAllBoxes");t.clearRect(0,0,e.width,e.height),t.drawImage(n,0,0),W().forEach(s=>{t.beginPath(),t.rect(s.startX,s.startY,s.width,s.height),St(),t.stroke()})},Lt=()=>{const t=O();t&&(t.reset(),G([]))},At=()=>{O()&&(G(t=>t.slice(0,t.length-1)),P())},kt=()=>{O()},Pt=()=>(q(()=>Tt()),q(()=>jt()),(()=>{const t=S(wt),e=t.firstChild,n=e.nextSibling;return st(s=>{const r=A().width,i=A().height,l="relative rounded-md"+A().imgData?"canvas-shadow-active":"canvas-shadow-inactive";return r!==s._v$&&L(n,"width",s._v$=r),i!==s._v$2&&L(n,"height",s._v$2=i),l!==s._v$3&&ht(n,s._v$3=l),s},{_v$:void 0,_v$2:void 0,_v$3:void 0}),t})()),Ut="application/json",lt="Content-Type",T=Symbol(),ct=Symbol();function V(t={}){var e;return(e=Object.entries(t).find(([n])=>n.toLowerCase()===lt.toLowerCase()))===null||e===void 0?void 0:e[1]}function tt(t){return/^application\/.*json.*/.test(t)}const E=function(t,e,n=!1){return Object.entries(e).reduce((s,[r,i])=>{const l=t[r];return Array.isArray(l)&&Array.isArray(i)?s[r]=n?[...l,...i]:i:typeof l=="object"&&typeof i=="object"?s[r]=E(l,i,n):s[r]=i,s},{...t})},B={options:{},errorType:"text",polyfills:{},polyfill(t,e=!0,n=!1,...s){const r=this.polyfills[t]||(typeof self<"u"?self[t]:null)||(typeof global<"u"?global[t]:null);if(e&&!r)throw new Error(t+" is not defined");return n&&r?new r(...s):r}};function It(t,e=!1){B.options=e?t:E(B.options,t)}function Mt(t,e=!1){B.polyfills=e?t:E(B.polyfills,t)}function Ft(t){B.errorType=t}const Yt=t=>e=>t.reduceRight((n,s)=>s(n),e)||e;class ut extends Error{}const Nt=t=>{const e=Object.create(null);t=t._addons.reduce((o,a)=>a.beforeRequest&&a.beforeRequest(o,t._options,e)||o,t);const{_url:n,_options:s,_config:r,_catchers:i,_resolvers:l,_middlewares:c,_addons:_}=t,u=new Map(i),p=E(r.options,s);let g=n;const v=Yt(c)((o,a)=>(g=o,r.polyfill("fetch")(o,a)))(n,p),x=new Error,$=v.catch(o=>{throw{[T]:o}}).then(o=>{if(!o.ok){const a=new ut;if(a.cause=x,a.stack=a.stack+`
CAUSE: `+x.stack,a.response=o,a.url=g,o.type==="opaque")throw a;return o.text().then(d=>{var f;if(a.message=d,r.errorType==="json"||((f=o.headers.get("Content-Type"))===null||f===void 0?void 0:f.split(";")[0])==="application/json")try{a.json=JSON.parse(d)}catch{}throw a.text=d,a.status=o.status,a})}return o}),R=o=>o.catch(a=>{const d=a.hasOwnProperty(T),f=d?a[T]:a,F=f?.status&&u.get(f.status)||u.get(f?.name)||d&&u.has(T)&&u.get(T);if(F)return F(f,t);const K=u.get(ct);if(K)return K(f,t);throw f}),y=o=>a=>R(o?$.then(d=>d&&d[o]()).then(d=>a?a(d):d):$.then(d=>a?a(d):d)),M={_wretchReq:t,_fetchReq:v,_sharedState:e,res:y(null),json:y("json"),blob:y("blob"),formData:y("formData"),arrayBuffer:y("arrayBuffer"),text:y("text"),error(o,a){return u.set(o,a),this},badRequest(o){return this.error(400,o)},unauthorized(o){return this.error(401,o)},forbidden(o){return this.error(403,o)},notFound(o){return this.error(404,o)},timeout(o){return this.error(408,o)},internalError(o){return this.error(500,o)},fetchError(o){return this.error(T,o)}},j=_.reduce((o,a)=>({...o,...a.resolver}),M);return l.reduce((o,a)=>a(o,t),j)},qt={_url:"",_options:{},_config:B,_catchers:new Map,_resolvers:[],_deferred:[],_middlewares:[],_addons:[],addon(t){return{...this,_addons:[...this._addons,t],...t.wretch}},errorType(t){return{...this,_config:{...this._config,errorType:t}}},polyfills(t,e=!1){return{...this,_config:{...this._config,polyfills:e?t:E(this._config.polyfills,t)}}},url(t,e=!1){if(e)return{...this,_url:t};const n=this._url.split("?");return{...this,_url:n.length>1?n[0]+t+"?"+n[1]:this._url+t}},options(t,e=!1){return{...this,_options:e?t:E(this._options,t)}},headers(t){return{...this,_options:E(this._options,{headers:t||{}})}},accept(t){return this.headers({Accept:t})},content(t){return this.headers({[lt]:t})},auth(t){return this.headers({Authorization:t})},catcher(t,e){const n=new Map(this._catchers);return n.set(t,e),{...this,_catchers:n}},catcherFallback(t){return this.catcher(ct,t)},resolve(t,e=!1){return{...this,_resolvers:e?[t]:[...this._resolvers,t]}},defer(t,e=!1){return{...this,_deferred:e?[t]:[...this._deferred,t]}},middlewares(t,e=!1){return{...this,_middlewares:e?t:[...this._middlewares,...t]}},fetch(t=this._options.method,e="",n=null){let s=this.url(e).options({method:t});const r=V(s._options.headers),i=typeof n=="object"&&(!s._options.headers||!r||tt(r));return s=n?i?s.json(n,r):s.body(n):s,Nt(s._deferred.reduce((l,c)=>c(l,l._url,l._options),s))},get(t=""){return this.fetch("GET",t)},delete(t=""){return this.fetch("DELETE",t)},put(t,e=""){return this.fetch("PUT",e,t)},post(t,e=""){return this.fetch("POST",e,t)},patch(t,e=""){return this.fetch("PATCH",e,t)},head(t=""){return this.fetch("HEAD",t)},opts(t=""){return this.fetch("OPTIONS",t)},body(t){return{...this,_options:{...this._options,body:t}}},json(t,e){const n=V(this._options.headers);return this.content(e||tt(n)&&n||Ut).body(JSON.stringify(t))}};function D(t="",e={}){return{...qt,_url:t,_options:e}}D.default=D;D.options=It;D.errorType=Ft;D.polyfills=Mt;D.WretchError=ut;var z=(t=>(t.ServerDown="Server seems to be down currently. You can still play around with the application, but the server won't be able to process your submission. Please try again later and if it persists please submit an issue on GitHub.",t.BadInput="Server received invalid input, but this is unexpected. You can try to refresh the page and try again. ",t.UncaughtError="An unexpected unknown error occurred. ",t))(z||{});const[U,dt]=C(null),Xt={serverBaseUrl:{development:"http://localhost:8080/",production:"https://capserver.ncn.dev/"}},Ht="production",I=Xt.serverBaseUrl[Ht],Jt=t=>dt({msg:z.BadInput,additionalDataStr:t.response.body?JSON.stringify(t.message):void 0}),Wt=D(I).resolve(t=>t.error(422,Jt)),Gt=async t=>{try{Z(!0);const e=`${I}submit`,n=new FormData;n.append("file",t.file),n.append("box_data",JSON.stringify({boxes:t.boxes})),n.append("intro","hello testing");const r=await(await fetch(e,{method:"POST",body:n})).json();Z(!1),ft({seg:`${I}${r.seg_img_path}`,outline:`${I}${r.outline_img_path}`}),console.log("response",r)}catch(e){console.log(e)}},zt=()=>{Wt.url("ping").get().json(t=>t).catch(t=>dt({msg:z.ServerDown}))},Kt=w('<div class="flex flex-col items-center"><input type="color"><label class="text-neutral-500">'),Zt=w('<button class="tool-button cursor-pointer"><!#><!/><label class="text-neutral-500 hover:text-sky-600 cursor-pointer">'),Qt=w('<button class="flex items-center gap-2 bg-green-600 disabled:bg-neutral-700 rounded-sm p-2 duration-300"><span>Submit</span><!#><!/>'),Vt=w('<div class="text-white text-md flex justify-center gap-4 items-start"><!#><!/><!#><!/><div class="mt-4 gap-4 flex text-center"><input type="file" accept="image/*" id="upload-input" class="w-32"></div><!#><!/><!#><!/><!#><!/>'),et=({id:t,label:e,onChange:n,defaultColor:s})=>(()=>{const r=S(Kt),i=r.firstChild,l=i.nextSibling;return H(i,"change",n),L(i,"id",t),L(i,"name",t),i.value=s,L(l,"for",t),h(l,e),r})(),nt=({icon:t,label:e,onClick:n})=>(()=>{const s=S(Zt),r=s.firstChild,[i,l]=b(r.nextSibling),c=i.nextSibling;return H(s,"click",n,!0),h(s,t,i,l),h(c,e),J(),s})(),te=()=>(()=>{const t=S(Qt),e=t.firstChild,n=e.nextSibling,[s,r]=b(n.nextSibling);return t.$$click=i=>Gt({intro:"placeholder intro msg",boxes:W(),file:A().file}),h(t,m(mt,{}),s,r),st(()=>t.disabled=yt()),J(),t})(),ee=()=>(()=>{const t=S(Vt),e=t.firstChild,[n,s]=b(e.nextSibling),r=n.nextSibling,[i,l]=b(r.nextSibling),c=i.nextSibling,_=c.firstChild,u=c.nextSibling,[p,g]=b(u.nextSibling),v=p.nextSibling,[x,$]=b(v.nextSibling),R=x.nextSibling,[y,M]=b(R.nextSibling);return h(t,m(et,{id:"drawing-color",label:"Drawing",defaultColor:ot,onChange:j=>xt(j.target.value)}),n,s),h(t,m(et,{id:"box-color",label:"Box",defaultColor:it,onChange:j=>$t(j.target.value)}),i,l),H(_,"click",kt,!0),h(t,m(nt,{get icon(){return m(pt,{})},label:"Undo",onClick:At}),p,g),h(t,m(nt,{get icon(){return m(gt,{cls:"text-lg"})},label:"Reset",onClick:Lt}),x,$),h(t,m(te,{}),y,M),J(),t})();_t(["click"]);const ne=w('<aside class="error-menu"><p>Error!</p><p></p><!#><!/>'),se=w("<p>"),re=()=>(()=>{const t=S(ne),e=t.firstChild,n=e.nextSibling,s=n.nextSibling,[r,i]=b(s.nextSibling);return h(n,()=>U()?.msg),h(t,(()=>{const l=rt(()=>!!U()?.additionalDataStr);return()=>l()&&(()=>{const c=S(se);return h(c,()=>U()?.additionalDataStr),c})()})(),r,i),t})(),oe=w('<div class="text-center flex flex-col items-center flex-auto"><main class="flex flex-col"><div class="flex flex-col mb-24"><h1 class="max-6-xs text-6xl text-sky-700 font-thin uppercase my-4">Capstone</h1><p class="text-md text-neutral-500">Tips</p><ul class="mb-8"><li class="basic-text">- Press ctrl + Z to undo last box</li><li class="basic-text">- Press Esc to stop drawing</li></ul><!#><!/><!#><!/></div><!#><!/>');function ae(){return q(()=>zt()),(()=>{const t=S(oe),e=t.firstChild,n=e.firstChild,s=n.firstChild,r=s.nextSibling,i=r.nextSibling,l=i.nextSibling,[c,_]=b(l.nextSibling),u=c.nextSibling,[p,g]=b(u.nextSibling),v=n.nextSibling,[x,$]=b(v.nextSibling);return h(n,(()=>{const R=rt(()=>!!U());return()=>R()&&m(re,{})})(),c,_),h(n,m(ee,{}),p,g),h(e,m(Pt,{}),x,$),t})()}export{ae as default};
